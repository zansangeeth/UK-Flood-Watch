/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as e}from"tslib";import{property as t}from"../../core/accessorSupport/decorators/property.js";import{cast as o}from"../../core/accessorSupport/decorators/cast.js";import"../../core/has.js";import"../../core/RandomLCG.js";import{subclass as i}from"../../core/accessorSupport/decorators/subclass.js";import r from"../Widget.js";import{loadCalciteComponents as s}from"./componentsUtils.js";import"./widgetUtils.js";import{messageBundle as n}from"./decorators/messageBundle.js";import{tsx as l}from"./jsxFactory.js";import"@arcgis/toolkit/dom";import c from"./FilterBuilder/FilterBuilderViewModel.js";const a={fab:!0,menu:!0},d="esri-filter-builder",p={base:d,conditionContainer:`${d}__condition-container`,operatorSelect:`${d}__operator-select`};let m=class extends r{constructor(e,t){super(e,t),this.messages=null,this.messagesCommon=null,this.viewModel=new c,this.visibleElements={...a}}loadDependencies(){return s({action:()=>import("@esri/calcite-components/dist/components/calcite-action"),"action-menu":()=>import("@esri/calcite-components/dist/components/calcite-action-menu"),block:()=>import("@esri/calcite-components/dist/components/calcite-block"),fab:()=>import("@esri/calcite-components/dist/components/calcite-fab"),option:()=>import("@esri/calcite-components/dist/components/calcite-option"),select:()=>import("@esri/calcite-components/dist/components/calcite-select")})}get conditionOperator(){return this.viewModel.conditionOperator}set conditionOperator(e){this.viewModel.conditionOperator=e}get count(){return this.viewModel.count}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get operators(){return this.viewModel.operators}set operators(e){this.viewModel.operators=e}get state(){return this.viewModel.state}castVisibleElements(e){return{...a,...e}}get whereClause(){return this.viewModel.whereClause}get whereClauses(){return this.viewModel.whereClauses}render(){return l("div",{class:p.base},this._renderOperatorSelect(),this._renderConditions(),this._renderFAB())}reset(){this.viewModel.reset()}_renderOperatorSelect(){if(this.count<2)return;const{conditionOperator:e,messages:t}=this,o="AND"===e;return l("div",{class:p.operatorSelect},l("calcite-select",{label:t.condition,width:"full",onCalciteSelectChange:({currentTarget:e})=>{this.conditionOperator=e.value}},l("calcite-option",{label:t.allAreTrue,selected:o,value:"AND"}),l("calcite-option",{label:t.anyAreTrue,selected:!o,value:"OR"})))}_renderConditions(){return this.viewModel.conditionWidgets.toArray().map((e,t)=>this._renderConditionContainer(e,t))}_renderConditionContainer(e,t){return l("calcite-block",{class:p.conditionContainer,expanded:!0,heading:this.messages.condition},e.render(),this._renderConditionrMenu(t))}_renderFAB(){if(!this.visibleElements.fab)return;const e="loading"===this.state;return l("calcite-fab",{appearance:"outline-fill",disabled:e,icon:"plus",kind:"neutral",loading:e,onclick:()=>this.viewModel.addCondition(),text:this.messages.addNew,textEnabled:!0})}_renderConditionrMenu(e){if(!this.visibleElements.menu)return;const{messages:t}=this;return l("calcite-action-menu",{label:t.moreOptions,overlayPositioning:"fixed",placement:"bottom-end",slot:"control"},l("calcite-action",{onclick:()=>this.viewModel.removeCondition(e),text:t.delete,textEnabled:!0}),l("calcite-action",{onclick:()=>this.viewModel.duplicateCondition(e),text:t.duplicate,textEnabled:!0}))}};e([t()],m.prototype,"conditionOperator",null),e([t()],m.prototype,"count",null),e([t()],m.prototype,"layer",null),e([t(),n("esri/widgets/support/FilterBuilder/t9n/FilterBuilder")],m.prototype,"messages",void 0),e([t(),n("esri/t9n/common")],m.prototype,"messagesCommon",void 0),e([t()],m.prototype,"operators",null),e([t()],m.prototype,"state",null),e([t()],m.prototype,"viewModel",void 0),e([t()],m.prototype,"visibleElements",void 0),e([o("visibleElements")],m.prototype,"castVisibleElements",null),e([t()],m.prototype,"whereClause",null),e([t()],m.prototype,"whereClauses",null),m=e([i("esri.widgets.support.FilterBuilder")],m);export{m as default};
