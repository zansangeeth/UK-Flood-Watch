/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as e}from"tslib";import r from"../../request.js";import{JSONSupport as o}from"../../core/JSONSupport.js";import{clone as s}from"../../core/lang.js";import{on as t,sync as i}from"../../core/reactiveUtils.js";import{property as a}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/Logger.js";import{reader as p}from"../../core/accessorSupport/decorators/reader.js";import{subclass as n}from"../../core/accessorSupport/decorators/subclass.js";import{persistable as c}from"../../core/accessorSupport/decorators/persistable.js";import m from"./PolygonCollection.js";import{f as l}from"../../chunks/persistableUrlUtils.js";var u;let g=u=class extends o{constructor(e){super(e),this.spatialRelationship="disjoint",this.geometries=new m,this._geometriesSource=null}initialize(){this.addHandles(t(()=>this.geometries,"after-changes",()=>this.geometries=this.geometries,i))}readGeometries(e,r,o){Array.isArray(e)?this.geometries=m.fromJSON(e,o):"web-scene"!==o.origin&&"portal-item"!==o.origin||(this._geometriesSource={url:l(e,o),context:o})}async loadGeometries(e,o){if(null==this._geometriesSource)return;const{url:s,context:t}=this._geometriesSource,i=await r(s,{responseType:"json",signal:o?.signal}),a=e.toJSON(),p=i.data.map(e=>({...e,spatialReference:a}));this.geometries=m.fromJSON(p,t),this._geometriesSource=null}clone(){const e=new u({geometries:s(this.geometries),spatialRelationship:this.spatialRelationship});return e._geometriesSource=this._geometriesSource,e}};e([a({type:["disjoint","contains"],nonNullable:!0,json:{write:{isRequired:!0}}})],g.prototype,"spatialRelationship",void 0),e([a({type:m,nonNullable:!0,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}}),c({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],g.prototype,"geometries",void 0),e([p(["web-scene","portal-item","service"],"geometries")],g.prototype,"readGeometries",null),g=u=e([n("esri.layers.support.SceneFilter")],g);const d=g;export{d as default};
